# TODO リスト

* [-] ｎ番勝負と裏のｍ勝先取の比が同じになる計算はスキップしたい ----> 廃止
* [x] ［表勝ちだけでの対局数］と、［裏勝ちだけでの対局数］に、共通の軸での価値を付けれるか？ ----> 通分を使う
* [x] `new_p` は `best_p` へ名称変更
* [x] CSV には、 `best_p` だけではなく、`latest_p` も保存しておきたい
* [x] 推奨するデータの p や誤差は、実際値ではなく、理論値にしたい
* [x] p=0.93 より上は探索に時間がかかるから省きたい。 p=0.99 とか、p=0.50～0.98 の探索時間の合計より時間かかる。 p=0.95 までは探索するか？ ----> 0.95 を上限にした
* [x] get_step_by() の challenged=FAILED は廃止したい
* [x] ファイル名の都合で、rate の入力は小数点第一位までにするか？それともパーミル？ ----> 小数点第一位まで
* [x] 先手勝率、後手勝率、引き分け率は、３つ合わせて１００％にするのではなく、先手勝率と後手勝率のペアを合わせて１００％にして、それとは別に引分け率を分けた方が見やすい？ ----> ThreeRates オブジェクト作成
* [ ] failure_rate が増えて upper_limit_coins が増えれば、かかる時間も増えていくし。 failure_rate は 70% までにするか？
* [ ] span ではなく、 upper_limit_coins の上限を抑え込みたい
* [x] BRUTE_FORCE とか THEORETICAL の分類を廃止したい。 BRUTE_FORCE を残して THEORETICAL を削除
* [x] `thoretical_probability_best.csv` がキー重複データだらけ、なんで？ ----> ループするデータフレームを間違えてた？
* [x] `theoretical_a_win_rate_abs_error` 列を廃止したい
* [x] temp/TPファイルの中身がバグってる？ TPテーブルに turn_system_name, failure_rate, p は要らない。ファイル名に書いてある
* [x] シリーズ・ルールは理論値で求められるようになったのだから、trial_series プロパティは要らない？ LargeSeriesTrialSummary の方に trial_series プロパティを付けるか？
* [x] KDS ファイルを CSV直書きから pandas へ変更したい
* [x] かくきんデータ・シートの列の並び順を変えたい
* [x] ［試行シリーズ数］が違うものを１つのファイルに混ぜたくない。ファイルを分けてある
* [x] TP 表に飛び番で挿入されてる？ --> 既存行を、最新行で上書きされてるのでは？ --> インデックスが被った行が挿入できてしまうのなんで？ロックしてない？同時書き込みで増える？ --> コード書き直し --> ２つのプログラムが１つのファイルに書き込むのは無理がある。ファイルを分けるなどして、ファイルと、それに書き込むプログラムは１対１にすること。
* [-] KDS ファイルは、理論値部とシミュレーション部に分けれるのでは？ --> 一緒にくっつけたものが KDS
* [x] h_step の初期値が 0 という仕様を廃止したい。 1 にしたい 
* [x] PCの強制終了時にファイルが破損してしまう？ ファイルのリネーム・バックアップを利用した安全なファイル更新はできないか？ --> 一部それで対応
* [x] 満点という言葉はおかしい、達成とかか？ --> リネームした
* [ ] TPR 表の `expected_a_win_rate` は、 `expected_a_victory_rate_by_duet` に変更したい
* [ ] TP、TPR のアルゴリズムの高速化
    * [ ] TP、TPR は、イーブンが見つかった行以降は無い方がいい
    * [-] TP、TPR で、span, t_step, h_step のいずれかに非素数が含まれていたらスキップしてもいいのではないか？（間引き） --> それが正しいか証明できてない
    * [x] span, t_step が同じで、 h_step だけが増えるとき、必ず先手勝率は同じか上がっていくから、その時点で 0.5 以上なら、続きは探索しなくていい
    * [ ] バイナリーサーチは作れるか？ h_step の範囲（ウィンドウ） H を min:max = 1～t_step と定義する。
            (A) mid を (min + max)/2 （小数点以下切捨）とし、 H[mid] の a_win_rate を書出し。
                (B1) H[t_step/2] が EVEN_ENOUGH なら探索終了
                (B2) EVEN_ENOUGH 未満なら H[min～mid-1] の a_win_rate を nan として書出し。 min を mid + 1 に再定義。 A に戻る
                (B3) EVEN_ENOUGH 以上なら H[mid+1～max] の a_win_rate を nan として書出し。 max を mid - 1 に再定義。 A に戻る
    * [ ] TPR に feedback_dropout 列を追加して、それが真なら TR の方から行削除するようにするか？ 作成と削除で無限に循環してハマらないか？ TR の最終行だけ削除しないようにできるか？
        * feedback_dropout が False になるようインナー・ジョインして、最終行だけアップサートすればどうか？
* [ ] Excel の別ブックのシートをスタイルまでコピーする練習をしておきたい
* [x] 樹形図をExcelで描けないか？ ----> xltree を使う
* [x] GTテーブルから不要列 face, winner, pts, rate を消す。xltree を使うから
* [x] GTテーブルの node 列数が 6 の固定長なのを、可変長にしたい。 xltree でツリーテーブルを作れないか？
* [x] KDS、KDWB ファイルに期待値の先手勝率と引分け率も入れたい
* [ ] コイン投げで引き分けがあるとどうなる？
    * [-] タイブレークを導入するか？ ----> ［将棋の引分け率］が上がればあがるほど、引き分けを勝ちにされた方が有利になってしまう
    * [ ] 勝ち点のスケールを２倍にしておいて、引分けになったら両者に勝ち点の半分が入るようにしたらどうか？
    * [ ] 引分けを加味した理論値はまだ造れてないから、generate は Frozen の failure_rate=0 にしか使えないのでは？ failure_rate を 0 以外にしたら、ローラーで探すべきでは？
    * [ ] 引分け時だけでなく、通常の［勝ち点］も、 failure_rate を踏まえて算出する必要があるのでは？
    * [ ] ［上限対局数］も、引き分けを考慮する前と、考慮したあとの内訳が見たい（［引き分け考慮前の対局数］の追加）
* [x] シリーズの中の１局を bout と呼ぶのを止めて、刻（こく；tick）に名称変更するか？ 2 刻（ticks） で 1 局（game） とか。分局とか。部局（department）とか。小局（こきょく；microgame）とか 積ん局（つんきょく；パイル；pile）とか。下層局（lower game）とか。呼び方を分けずに game と呼ぶか？ あるいは 問（fight；ファイト） とか。ボーリングのフレーム（frame）は野球のイニング（inning）と同じ。数列なら 項（term；ターム）。すごろくのマスは Square。あるいは単に 回（time）と呼ぶか。リーグの第３回戦の第２ピリオドとか。第何段？　数詞としてでかい。１コマ（frame）とするか。それだったら１タイム（刻；time）ぐらいが分かりやすいか？ 数詞だけの問題か？ じゃあ回（time）でいいか。----> time は step * time = span で使ってるので、どちらかというとステップの方が適している。 step は結局 point の言い換えなので、数詞は１点、２点……となる。回数という意味では time で合ってる。 ---> time にした
* [ ] 勝ち点はＡさんとＢさんが持っているものであって、表番と裏番が持っていることに意味はないのでは？
